
-- SELECT statement for DiagnosticReport
SELECT 
    resourcetype,
    id,
    meta_versionid,
    meta_lastupdated,
    meta_source,
    identifier_0_system,
    identifier_0_value,
    identifier_1_system,
    identifier_1_value,
    status,
    code_coding_0_system,
    code_coding_0_code,
    code_coding_0_display,
    code_coding_1_system,
    code_coding_1_code,
    code_coding_1_display,
    code_coding_2_system,
    code_coding_2_code,
    code_coding_2_display,
    code_coding_3_system,
    code_coding_3_code,
    code_coding_3_display,
    code_coding_4_system,
    code_coding_4_code,
    code_coding_4_display,
    code_text,
    subject_reference,
    encounter_reference,
    effectiveperiod_start,
    performer_0_reference,
    performer_1_reference,
    presentedform_0_contenttype,
    presentedform_0_data,
    category_0_coding_0_system,
    category_0_coding_0_code,
    category_0_coding_0_display,
    result_0_reference,
    effectiveperiod_end,
    result_1_reference,
    result_2_reference,
    presentedform_1_contenttype,
    presentedform_1_data,
    presentedform_2_contenttype,
    presentedform_2_data,
    identifier_2_system,
    identifier_2_value,
    identifier_3_system,
    identifier_3_value,
    identifier_4_system,
    identifier_4_value,
    identifier_5_system,
    identifier_5_value,
    performer_2_reference,
    performer_3_reference,
    identifier_6_system,
    identifier_6_value,
    result_3_reference,
    result_4_reference,
    result_5_reference,
    result_6_reference,
    result_7_reference,
    presentedform_3_contenttype,
    presentedform_3_data,
    presentedform_4_contenttype,
    presentedform_4_data,
    presentedform_5_contenttype,
    presentedform_5_data,
    presentedform_6_contenttype,
    presentedform_6_data,
    result_8_reference,
    result_9_reference,
    result_10_reference,
    result_11_reference,
    result_12_reference,
    result_13_reference,
    result_14_reference,
    result_15_reference,
    result_16_reference,
    result_17_reference,
    result_18_reference,
    result_19_reference,
    result_20_reference,
    result_21_reference,
    result_22_reference,
    result_23_reference,
    result_24_reference,
    result_25_reference,
    result_26_reference,
    result_27_reference,
    result_28_reference,
    result_29_reference,
    result_30_reference,
    result_31_reference,
    result_32_reference,
    result_33_reference,
    result_34_reference,
    result_35_reference,
    result_36_reference,
    result_37_reference,
    result_38_reference,
    result_39_reference,
    result_40_reference,
    result_41_reference,
    result_42_reference,
    result_43_reference,
    result_44_reference,
    result_45_reference,
    result_46_reference,
    result_47_reference,
    result_48_reference,
    identifier_7_system,
    identifier_7_value,
    identifier_8_system,
    identifier_8_value,
    identifier_9_system,
    identifier_9_value,
    code_coding_5_code,
    code_coding_5_display,
    code_coding_5_system,
    code_coding_6_code,
    code_coding_6_display,
    code_coding_6_system,
    code_coding_7_code,
    code_coding_7_display,
    code_coding_7_system,
    code_coding_8_code,
    code_coding_8_display,
    code_coding_8_system,
    code_coding_9_code,
    code_coding_9_display,
    code_coding_9_system,
    result_49_reference,
    result_50_reference,
    result_51_reference,
    result_52_reference,
    result_53_reference,
    result_54_reference,
    result_55_reference,
    presentedform_7_contenttype,
    presentedform_7_data,
    identifier_10_system,
    identifier_10_value,
    effectivedatetime,
    identifier_0_type_text,
    identifier_0_assigner_display,
    identifier_1_assigner_display,
    identifier_1_type_text,
    identifier_2_type_text,
    identifier_3_type_text,
    category_1_coding_0_code,
    category_1_coding_0_display,
    category_1_coding_0_system,
    identifier_4_type_text,
    identifier_5_type_text,
    identifier_6_type_text,
    identifier_7_type_text,
    identifier_8_type_text,
    result_56_reference,
    result_57_reference,
    identifier_11_system,
    identifier_11_value,
    identifier_12_system,
    identifier_12_value,
    identifier_13_system,
    identifier_13_value,
    identifier_14_system,
    identifier_14_value,
    identifier_15_system,
    identifier_15_value,
    identifier_16_system,
    identifier_16_value,
    performer_4_reference,
    performer_5_reference,
    performer_6_reference,
    performer_7_reference,
    performer_8_reference,
    result_58_reference,
    result_59_reference,
    result_60_reference,
    result_61_reference,
    result_62_reference,
    result_63_reference,
    identifier_17_system,
    identifier_17_value,
    identifier_18_system,
    identifier_18_value,
    identifier_19_system,
    identifier_19_value,
    result_64_reference,
    result_65_reference,
    result_66_reference,
    result_67_reference,
    result_68_reference,
    result_69_reference,
    result_70_reference,
    result_71_reference,
    result_72_reference,
    result_73_reference,
    result_74_reference,
    result_75_reference,
    result_76_reference,
    result_77_reference,
    result_78_reference,
    result_79_reference,
    result_80_reference,
    result_81_reference,
    result_82_reference,
    result_83_reference,
    result_84_reference,
    result_85_reference,
    presentedform_8_contenttype,
    presentedform_8_data,
    presentedform_9_contenttype,
    presentedform_9_data,
    presentedform_10_contenttype,
    presentedform_10_data,
    presentedform_11_contenttype,
    presentedform_11_data,
    presentedform_12_contenttype,
    presentedform_12_data,
    presentedform_13_contenttype,
    presentedform_13_data,
    presentedform_14_contenttype,
    presentedform_14_data,
    presentedform_15_contenttype,
    presentedform_15_data,
    presentedform_16_contenttype,
    presentedform_16_data,
    presentedform_17_contenttype,
    presentedform_17_data,
    presentedform_18_contenttype,
    presentedform_18_data,
    presentedform_19_contenttype,
    presentedform_19_data,
    presentedform_20_contenttype,
    presentedform_20_data,
    presentedform_21_contenttype,
    presentedform_21_data,
    presentedform_22_contenttype,
    presentedform_22_data,
    presentedform_23_contenttype,
    presentedform_23_data,
    presentedform_24_contenttype,
    presentedform_24_data,
    presentedform_25_contenttype,
    presentedform_25_data,
    presentedform_26_contenttype,
    presentedform_26_data,
    presentedform_27_contenttype,
    presentedform_27_data,
    presentedform_28_contenttype,
    presentedform_28_data,
    presentedform_29_contenttype,
    presentedform_29_data,
    presentedform_30_contenttype,
    presentedform_30_data,
    presentedform_31_contenttype,
    presentedform_31_data,
    presentedform_32_contenttype,
    presentedform_32_data,
    presentedform_33_contenttype,
    presentedform_33_data,
    presentedform_34_contenttype,
    presentedform_34_data,
    presentedform_35_contenttype,
    presentedform_35_data,
    presentedform_36_contenttype,
    presentedform_36_data,
    presentedform_37_contenttype,
    presentedform_37_data,
    presentedform_38_contenttype,
    presentedform_38_data,
    presentedform_39_contenttype,
    presentedform_39_data,
    presentedform_40_contenttype,
    presentedform_40_data,
    presentedform_41_contenttype,
    presentedform_41_data,
    presentedform_42_contenttype,
    presentedform_42_data,
    code_coding_10_code,
    code_coding_10_display,
    code_coding_10_system,
    code_coding_11_code,
    code_coding_11_display,
    code_coding_11_system,
    code_coding_12_code,
    code_coding_12_display,
    code_coding_12_system,
    code_coding_13_code,
    code_coding_13_display,
    code_coding_13_system,
    filename,
    processed_date 
FROM {{source('raw', 'diagnosticreport') }} x

QUALIFY rank() over(partition by filename order by processed_date desc) = 1