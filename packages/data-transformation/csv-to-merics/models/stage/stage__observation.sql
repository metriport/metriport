
-- SELECT statement for Observation
SELECT 
    resourcetype,
    id,
    meta_versionid,
    meta_lastupdated,
    meta_source,
    identifier_0_system,
    identifier_0_value,
    identifier_1_system,
    identifier_1_value,
    identifier_2_system,
    identifier_2_value,
    status,
    category_0_coding_0_system,
    category_0_coding_0_code,
    category_0_coding_0_display,
    category_0_text,
    code_coding_0_system,
    code_coding_0_code,
    code_coding_0_display,
    code_text,
    subject_reference,
    performer_0_reference,
    performer_1_reference,
    performer_2_reference,
    performer_3_reference,
    performer_4_reference,
    valuecodeableconcept_coding_0_system,
    valuecodeableconcept_coding_0_code,
    valuecodeableconcept_coding_0_display,
    valuecodeableconcept_coding_1_system,
    valuecodeableconcept_coding_1_code,
    valuecodeableconcept_coding_1_display,
    valuecodeableconcept_text,
    performer_5_reference,
    performer_6_reference,
    effectiveperiod_start,
    effectiveperiod_end,
    code_coding_1_system,
    code_coding_1_code,
    code_coding_1_display,
    effectivedatetime,
    valuequantity_value,
    valuequantity_unit,
    valuequantity_system,
    valuestring,
    interpretation_0_coding_0_system,
    interpretation_0_coding_0_code,
    referencerange_0_low_value,
    referencerange_0_low_unit,
    referencerange_0_low_system,
    referencerange_0_high_value,
    referencerange_0_high_unit,
    referencerange_0_high_system,
    bodysite_coding_0_system,
    bodysite_coding_0_code,
    bodysite_text,
    performer_7_reference,
    performer_8_reference,
    performer_9_reference,
    performer_10_reference,
    performer_11_reference,
    performer_12_reference,
    performer_13_reference,
    performer_14_reference,
    identifier_3_system,
    identifier_3_value,
    identifier_4_system,
    identifier_4_value,
    identifier_5_system,
    identifier_5_value,
    identifier_6_system,
    identifier_6_value,
    performer_15_reference,
    performer_16_reference,
    performer_17_reference,
    performer_18_reference,
    performer_19_reference,
    performer_20_reference,
    performer_21_reference,
    performer_22_reference,
    performer_23_reference,
    performer_24_reference,
    performer_25_reference,
    performer_26_reference,
    performer_27_reference,
    performer_28_reference,
    performer_29_reference,
    performer_30_reference,
    performer_31_reference,
    performer_32_reference,
    performer_33_reference,
    performer_34_reference,
    performer_35_reference,
    performer_36_reference,
    code_coding_2_system,
    code_coding_2_code,
    code_coding_2_display,
    identifier_0_type_text,
    interpretation_0_text,
    performer_37_reference,
    performer_38_reference,
    performer_39_reference,
    performer_40_reference,
    performer_41_reference,
    performer_42_reference,
    performer_43_reference,
    performer_44_reference,
    performer_45_reference,
    performer_46_reference,
    performer_47_reference,
    performer_48_reference,
    performer_49_reference,
    performer_50_reference,
    performer_51_reference,
    performer_52_reference,
    performer_53_reference,
    performer_54_reference,
    performer_55_reference,
    identifier_7_system,
    identifier_7_value,
    identifier_8_system,
    identifier_8_value,
    identifier_9_system,
    identifier_9_value,
    identifier_10_system,
    identifier_10_value,
    identifier_11_system,
    identifier_11_value,
    identifier_1_type_text,
    interpretation_0_coding_0_display,
    performer_56_reference,
    performer_57_reference,
    performer_58_reference,
    performer_59_reference,
    performer_60_reference,
    performer_61_reference,
    performer_62_reference,
    performer_63_reference,
    performer_64_reference,
    performer_65_reference,
    performer_66_reference,
    performer_67_reference,
    performer_68_reference,
    performer_69_reference,
    performer_70_reference,
    performer_71_reference,
    performer_72_reference,
    performer_73_reference,
    performer_74_reference,
    performer_75_reference,
    performer_76_reference,
    performer_77_reference,
    performer_78_reference,
    performer_79_reference,
    performer_80_reference,
    performer_81_reference,
    performer_82_reference,
    performer_83_reference,
    performer_84_reference,
    performer_85_reference,
    performer_86_reference,
    performer_87_reference,
    performer_88_reference,
    performer_89_reference,
    performer_90_reference,
    performer_91_reference,
    performer_92_reference,
    performer_93_reference,
    performer_94_reference,
    performer_95_reference,
    performer_96_reference,
    performer_97_reference,
    performer_98_reference,
    performer_99_reference,
    identifier_12_system,
    identifier_12_value,
    identifier_13_system,
    identifier_13_value,
    identifier_14_system,
    identifier_14_value,
    identifier_15_system,
    identifier_15_value,
    identifier_16_system,
    identifier_16_value,
    identifier_17_system,
    identifier_17_value,
    identifier_18_system,
    identifier_18_value,
    identifier_19_system,
    identifier_19_value,
    identifier_20_system,
    identifier_20_value,
    identifier_21_system,
    identifier_21_value,
    identifier_22_system,
    identifier_22_value,
    identifier_23_system,
    identifier_23_value,
    identifier_24_system,
    identifier_24_value,
    identifier_25_system,
    identifier_25_value,
    identifier_26_system,
    identifier_26_value,
    identifier_27_system,
    identifier_27_value,
    identifier_28_system,
    identifier_28_value,
    identifier_29_system,
    identifier_29_value,
    identifier_30_system,
    identifier_30_value,
    identifier_31_system,
    identifier_31_value,
    identifier_32_system,
    identifier_32_value,
    identifier_33_system,
    identifier_33_value,
    identifier_34_system,
    identifier_34_value,
    identifier_35_system,
    identifier_35_value,
    identifier_36_system,
    identifier_36_value,
    identifier_37_system,
    identifier_37_value,
    identifier_38_system,
    identifier_38_value,
    identifier_39_system,
    identifier_39_value,
    identifier_40_system,
    identifier_40_value,
    identifier_41_system,
    identifier_41_value,
    interpretation_1_text,
    interpretation_1_coding_0_system,
    referencerange_1_high_value,
    referencerange_1_high_system,
    referencerange_1_low_value,
    referencerange_1_low_unit,
    referencerange_1_low_system,
    referencerange_1_high_unit,
    valuecodeableconcept_coding_2_code,
    valuecodeableconcept_coding_2_display,
    valuecodeableconcept_coding_2_system,
    interpretation_0_coding_1_system,
    interpretation_0_coding_1_code,
    interpretation_0_coding_1_display,
    identifier_42_system,
    identifier_42_value,
    identifier_43_system,
    identifier_43_value,
    identifier_44_system,
    identifier_44_value,
    identifier_45_system,
    identifier_45_value,
    identifier_46_system,
    identifier_46_value,
    identifier_47_system,
    identifier_47_value,
    identifier_48_system,
    identifier_48_value,
    identifier_49_system,
    identifier_49_value,
    identifier_50_system,
    identifier_50_value,
    identifier_51_system,
    identifier_51_value,
    identifier_52_system,
    identifier_52_value,
    identifier_53_system,
    identifier_53_value,
    identifier_54_system,
    identifier_54_value,
    identifier_55_system,
    identifier_55_value,
    identifier_56_system,
    identifier_56_value,
    identifier_57_system,
    identifier_57_value,
    identifier_58_system,
    identifier_58_value,
    identifier_59_system,
    identifier_59_value,
    identifier_60_system,
    identifier_60_value,
    identifier_61_system,
    identifier_61_value,
    identifier_62_system,
    identifier_62_value,
    identifier_63_system,
    identifier_63_value,
    identifier_64_system,
    identifier_64_value,
    identifier_65_system,
    identifier_65_value,
    identifier_66_system,
    identifier_66_value,
    identifier_67_system,
    identifier_67_value,
    identifier_68_system,
    identifier_68_value,
    identifier_69_system,
    identifier_69_value,
    identifier_70_system,
    identifier_70_value,
    identifier_71_system,
    identifier_71_value,
    identifier_72_system,
    identifier_72_value,
    filename,
    processed_date 
FROM {{source('raw', 'observation') }} x

QUALIFY rank() over(partition by filename order by processed_date desc) = 1