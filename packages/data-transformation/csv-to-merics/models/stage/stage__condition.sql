
-- SELECT statement for Condition
SELECT 
    resourcetype,
    id,
    meta_versionid,
    meta_lastupdated,
    meta_source,
    identifier_0_system,
    identifier_0_value,
    clinicalstatus_coding_0_system,
    clinicalstatus_coding_0_code,
    category_0_coding_0_system,
    category_0_coding_0_code,
    category_0_coding_0_display,
    category_0_coding_1_system,
    category_0_coding_1_code,
    category_0_coding_1_display,
    code_coding_0_system,
    code_coding_0_code,
    code_coding_0_display,
    code_text,
    subject_reference,
    onsetperiod_start,
    onsetperiod_end,
    recorder_reference,
    category_0_text,
    code_coding_1_system,
    code_coding_1_code,
    code_coding_1_display,
    clinicalstatus_coding_0_display,
    code_coding_2_system,
    code_coding_2_code,
    code_coding_2_display,
    code_coding_3_system,
    code_coding_3_code,
    code_coding_3_display,
    identifier_1_system,
    identifier_1_value,
    category_1_coding_0_system,
    category_1_coding_0_code,
    category_1_coding_1_system,
    category_1_coding_1_code,
    identifier_0_type_text,
    clinicalstatus_coding_1_code,
    clinicalstatus_coding_1_display,
    clinicalstatus_coding_1_system,
    category_1_coding_1_display,
    identifier_1_type_text,
    category_1_coding_0_display,
    identifier_2_system,
    identifier_2_value,
    identifier_2_type_text,
    identifier_3_system,
    identifier_3_value,
    identifier_3_type_text,
    identifier_4_system,
    identifier_4_value,
    identifier_4_type_text,
    identifier_5_system,
    identifier_5_value,
    identifier_5_type_text,
    identifier_6_system,
    identifier_6_value,
    identifier_6_type_text,
    code_coding_4_code,
    code_coding_4_display,
    code_coding_4_system,
    category_1_text,
    code_coding_5_code,
    code_coding_5_display,
    code_coding_5_system,
    identifier_7_system,
    identifier_7_value,
    identifier_8_system,
    identifier_8_value,
    identifier_9_system,
    identifier_9_value,
    identifier_10_system,
    identifier_10_value,
    identifier_11_system,
    identifier_11_value,
    code_coding_6_code,
    code_coding_6_display,
    code_coding_6_system,
    code_coding_7_code,
    code_coding_7_display,
    code_coding_7_system,
    code_coding_8_code,
    code_coding_8_display,
    code_coding_8_system,
    identifier_12_system,
    identifier_12_value,
    identifier_13_system,
    identifier_13_value,
    identifier_14_system,
    identifier_14_value,
    identifier_15_system,
    identifier_15_value,
    identifier_16_system,
    identifier_16_value,
    identifier_17_system,
    identifier_17_value,
    identifier_18_system,
    identifier_18_value,
    identifier_19_system,
    identifier_19_value,
    identifier_20_system,
    identifier_20_value,
    identifier_21_system,
    identifier_21_value,
    identifier_22_system,
    identifier_22_value,
    identifier_23_system,
    identifier_23_value,
    identifier_24_system,
    identifier_24_value,
    identifier_25_system,
    identifier_25_value,
    category_2_coding_0_code,
    category_2_coding_0_system,
    category_2_coding_1_code,
    category_2_coding_1_system,
    category_2_text,
    filename,
    processed_date 
FROM {{source('raw', 'condition') }} x

QUALIFY rank() over(partition by filename order by processed_date desc) = 1