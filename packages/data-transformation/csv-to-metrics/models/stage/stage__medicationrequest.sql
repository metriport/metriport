
-- SELECT statement for MedicationRequest
SELECT 
    resourcetype,
    id,
    meta_versionid,
    meta_lastupdated,
    meta_source,
    identifier_0_system,
    identifier_0_type_text,
    identifier_0_value,
    identifier_1_system,
    identifier_1_type_text,
    identifier_1_value,
    identifier_2_system,
    identifier_2_type_text,
    identifier_2_value,
    identifier_3_system,
    identifier_3_type_text,
    identifier_3_value,
    identifier_4_system,
    identifier_4_type_text,
    identifier_4_value,
    subject_reference,
    authoredon,
    category_0_coding_0_code,
    category_0_coding_0_display,
    category_0_coding_0_system,
    category_0_coding_1_code,
    category_0_coding_1_display,
    category_0_coding_1_system,
    category_0_text,
    category_1_coding_0_code,
    category_1_coding_0_display,
    category_1_coding_0_system,
    category_1_coding_1_code,
    category_1_coding_1_display,
    category_1_coding_1_system,
    category_1_text,
    courseoftherapytype_coding_0_code,
    courseoftherapytype_coding_0_display,
    courseoftherapytype_coding_0_system,
    courseoftherapytype_coding_1_code,
    courseoftherapytype_coding_1_display,
    courseoftherapytype_coding_1_system,
    courseoftherapytype_text,
    detectedissue_0_reference,
    detectedissue_1_reference,
    dispenserequest_dispenseinterval,
    dispenserequest_expectedsupplyduration,
    dispenserequest_initialfill_duration,
    dispenserequest_initialfill_quantity,
    dispenserequest_numberofrepeatsallowed,
    dispenserequest_performer_reference,
    dispenserequest_quantity,
    dispenserequest_validityperiod_end,
    dispenserequest_validityperiod_start,
    donotperform,
    dosageinstruction_0_additionalinstruction_0_coding_0_code,
    dosageinstruction_0_additionalinstruction_0_coding_0_display,
    dosageinstruction_0_additionalinstruction_0_coding_0_system,
    dosageinstruction_0_additionalinstruction_0_coding_1_code,
    dosageinstruction_0_additionalinstruction_0_coding_1_display,
    dosageinstruction_0_additionalinstruction_0_coding_1_system,
    dosageinstruction_0_additionalinstruction_0_text,
    dosageinstruction_0_additionalinstruction_1_coding_0_code,
    dosageinstruction_0_additionalinstruction_1_coding_0_display,
    dosageinstruction_0_additionalinstruction_1_coding_0_system,
    dosageinstruction_0_additionalinstruction_1_coding_1_code,
    dosageinstruction_0_additionalinstruction_1_coding_1_display,
    dosageinstruction_0_additionalinstruction_1_coding_1_system,
    dosageinstruction_0_additionalinstruction_1_text,
    dosageinstruction_0_additionalinstruction_2_coding_0_code,
    dosageinstruction_0_additionalinstruction_2_coding_0_display,
    dosageinstruction_0_additionalinstruction_2_coding_0_system,
    dosageinstruction_0_additionalinstruction_2_coding_1_code,
    dosageinstruction_0_additionalinstruction_2_coding_1_display,
    dosageinstruction_0_additionalinstruction_2_coding_1_system,
    dosageinstruction_0_additionalinstruction_2_text,
    dosageinstruction_0_asneededboolean,
    dosageinstruction_0_asneededcodeableconcept_coding_0_code,
    dosageinstruction_0_asneededcodeableconcept_coding_0_display,
    dosageinstruction_0_asneededcodeableconcept_coding_0_system,
    dosageinstruction_0_asneededcodeableconcept_coding_1_code,
    dosageinstruction_0_asneededcodeableconcept_coding_1_display,
    dosageinstruction_0_asneededcodeableconcept_coding_1_system,
    dosageinstruction_0_asneededcodeableconcept_text,
    dosageinstruction_0_doseandrate_0_dosequantity_code,
    dosageinstruction_0_doseandrate_0_dosequantity_system,
    dosageinstruction_0_doseandrate_0_dosequantity_unit,
    dosageinstruction_0_doseandrate_0_dosequantity_value,
    dosageinstruction_0_doseandrate_0_doserange_high_code,
    dosageinstruction_0_doseandrate_0_doserange_high_system,
    dosageinstruction_0_doseandrate_0_doserange_high_unit,
    dosageinstruction_0_doseandrate_0_doserange_high_value,
    dosageinstruction_0_doseandrate_0_doserange_low_code,
    dosageinstruction_0_doseandrate_0_doserange_low_system,
    dosageinstruction_0_doseandrate_0_doserange_low_unit,
    dosageinstruction_0_doseandrate_0_doserange_low_value,
    dosageinstruction_0_doseandrate_0_ratequantity,
    dosageinstruction_0_doseandrate_0_raterange_high_code,
    dosageinstruction_0_doseandrate_0_raterange_high_system,
    dosageinstruction_0_doseandrate_0_raterange_high_unit,
    dosageinstruction_0_doseandrate_0_raterange_high_value,
    dosageinstruction_0_doseandrate_0_raterange_low_code,
    dosageinstruction_0_doseandrate_0_raterange_low_system,
    dosageinstruction_0_doseandrate_0_raterange_low_unit,
    dosageinstruction_0_doseandrate_0_raterange_low_value,
    dosageinstruction_0_doseandrate_0_rateratio_denominator_code,
    dosageinstruction_0_doseandrate_0_rateratio_denominator_comparator,
    dosageinstruction_0_doseandrate_0_rateratio_denominator_system,
    dosageinstruction_0_doseandrate_0_rateratio_denominator_unit,
    dosageinstruction_0_doseandrate_0_rateratio_denominator_value,
    dosageinstruction_0_doseandrate_0_rateratio_numerator_code,
    dosageinstruction_0_doseandrate_0_rateratio_numerator_comparator,
    dosageinstruction_0_doseandrate_0_rateratio_numerator_system,
    dosageinstruction_0_doseandrate_0_rateratio_numerator_unit,
    dosageinstruction_0_doseandrate_0_rateratio_numerator_value,
    dosageinstruction_0_doseandrate_0_type_coding_0_code,
    dosageinstruction_0_doseandrate_0_type_coding_0_display,
    dosageinstruction_0_doseandrate_0_type_coding_0_system,
    dosageinstruction_0_doseandrate_0_type_coding_1_code,
    dosageinstruction_0_doseandrate_0_type_coding_1_display,
    dosageinstruction_0_doseandrate_0_type_coding_1_system,
    dosageinstruction_0_doseandrate_0_type_text,
    dosageinstruction_0_maxdoseperadministration,
    dosageinstruction_0_maxdoseperlifetime,
    dosageinstruction_0_maxdoseperperiod_denominator_code,
    dosageinstruction_0_maxdoseperperiod_denominator_comparator,
    dosageinstruction_0_maxdoseperperiod_denominator_system,
    dosageinstruction_0_maxdoseperperiod_denominator_unit,
    dosageinstruction_0_maxdoseperperiod_denominator_value,
    dosageinstruction_0_maxdoseperperiod_numerator_code,
    dosageinstruction_0_maxdoseperperiod_numerator_comparator,
    dosageinstruction_0_maxdoseperperiod_numerator_system,
    dosageinstruction_0_maxdoseperperiod_numerator_unit,
    dosageinstruction_0_maxdoseperperiod_numerator_value,
    dosageinstruction_0_method_coding_0_code,
    dosageinstruction_0_method_coding_0_display,
    dosageinstruction_0_method_coding_0_system,
    dosageinstruction_0_method_coding_1_code,
    dosageinstruction_0_method_coding_1_display,
    dosageinstruction_0_method_coding_1_system,
    dosageinstruction_0_method_text,
    dosageinstruction_0_patientinstruction,
    dosageinstruction_0_route_coding_0_code,
    dosageinstruction_0_route_coding_0_display,
    dosageinstruction_0_route_coding_0_system,
    dosageinstruction_0_route_coding_1_code,
    dosageinstruction_0_route_coding_1_display,
    dosageinstruction_0_route_coding_1_system,
    dosageinstruction_0_route_text,
    dosageinstruction_0_sequence,
    dosageinstruction_0_site_coding_0_code,
    dosageinstruction_0_site_coding_0_display,
    dosageinstruction_0_site_coding_0_system,
    dosageinstruction_0_site_coding_1_code,
    dosageinstruction_0_site_coding_1_display,
    dosageinstruction_0_site_coding_1_system,
    dosageinstruction_0_site_text,
    dosageinstruction_0_text,
    dosageinstruction_0_timing_code_coding_0_code,
    dosageinstruction_0_timing_code_coding_0_display,
    dosageinstruction_0_timing_code_coding_0_system,
    dosageinstruction_0_timing_code_coding_1_code,
    dosageinstruction_0_timing_code_coding_1_display,
    dosageinstruction_0_timing_code_coding_1_system,
    dosageinstruction_0_timing_code_text,
    dosageinstruction_0_timing_event_0,
    dosageinstruction_0_timing_event_1,
    dosageinstruction_0_timing_event_2,
    dosageinstruction_0_timing_repeat_boundsduration,
    dosageinstruction_0_timing_repeat_boundsperiod_end,
    dosageinstruction_0_timing_repeat_boundsperiod_start,
    dosageinstruction_0_timing_repeat_boundsrange_high_code,
    dosageinstruction_0_timing_repeat_boundsrange_high_system,
    dosageinstruction_0_timing_repeat_boundsrange_high_unit,
    dosageinstruction_0_timing_repeat_boundsrange_high_value,
    dosageinstruction_0_timing_repeat_boundsrange_low_code,
    dosageinstruction_0_timing_repeat_boundsrange_low_system,
    dosageinstruction_0_timing_repeat_boundsrange_low_unit,
    dosageinstruction_0_timing_repeat_boundsrange_low_value,
    dosageinstruction_0_timing_repeat_count,
    dosageinstruction_0_timing_repeat_countmax,
    dosageinstruction_0_timing_repeat_dayofweek_0,
    dosageinstruction_0_timing_repeat_dayofweek_1,
    dosageinstruction_0_timing_repeat_dayofweek_2,
    dosageinstruction_0_timing_repeat_duration,
    dosageinstruction_0_timing_repeat_durationmax,
    dosageinstruction_0_timing_repeat_durationunit,
    dosageinstruction_0_timing_repeat_frequency,
    dosageinstruction_0_timing_repeat_frequencymax,
    dosageinstruction_0_timing_repeat_offset,
    dosageinstruction_0_timing_repeat_period,
    dosageinstruction_0_timing_repeat_periodmax,
    dosageinstruction_0_timing_repeat_periodunit,
    dosageinstruction_0_timing_repeat_timeofday_0,
    dosageinstruction_0_timing_repeat_timeofday_1,
    dosageinstruction_0_timing_repeat_timeofday_2,
    dosageinstruction_0_timing_repeat_when_0,
    dosageinstruction_0_timing_repeat_when_1,
    dosageinstruction_0_timing_repeat_when_2,
    dosageinstruction_1_additionalinstruction_0_coding_0_code,
    dosageinstruction_1_additionalinstruction_0_coding_0_display,
    dosageinstruction_1_additionalinstruction_0_coding_0_system,
    dosageinstruction_1_additionalinstruction_0_coding_1_code,
    dosageinstruction_1_additionalinstruction_0_coding_1_display,
    dosageinstruction_1_additionalinstruction_0_coding_1_system,
    dosageinstruction_1_additionalinstruction_0_text,
    dosageinstruction_1_additionalinstruction_1_coding_0_code,
    dosageinstruction_1_additionalinstruction_1_coding_0_display,
    dosageinstruction_1_additionalinstruction_1_coding_0_system,
    dosageinstruction_1_additionalinstruction_1_coding_1_code,
    dosageinstruction_1_additionalinstruction_1_coding_1_display,
    dosageinstruction_1_additionalinstruction_1_coding_1_system,
    dosageinstruction_1_additionalinstruction_1_text,
    dosageinstruction_1_additionalinstruction_2_coding_0_code,
    dosageinstruction_1_additionalinstruction_2_coding_0_display,
    dosageinstruction_1_additionalinstruction_2_coding_0_system,
    dosageinstruction_1_additionalinstruction_2_coding_1_code,
    dosageinstruction_1_additionalinstruction_2_coding_1_display,
    dosageinstruction_1_additionalinstruction_2_coding_1_system,
    dosageinstruction_1_additionalinstruction_2_text,
    dosageinstruction_1_asneededboolean,
    dosageinstruction_1_asneededcodeableconcept_coding_0_code,
    dosageinstruction_1_asneededcodeableconcept_coding_0_display,
    dosageinstruction_1_asneededcodeableconcept_coding_0_system,
    dosageinstruction_1_asneededcodeableconcept_coding_1_code,
    dosageinstruction_1_asneededcodeableconcept_coding_1_display,
    dosageinstruction_1_asneededcodeableconcept_coding_1_system,
    dosageinstruction_1_asneededcodeableconcept_text,
    dosageinstruction_1_doseandrate_0_dosequantity_code,
    dosageinstruction_1_doseandrate_0_dosequantity_system,
    dosageinstruction_1_doseandrate_0_dosequantity_unit,
    dosageinstruction_1_doseandrate_0_dosequantity_value,
    dosageinstruction_1_doseandrate_0_doserange_high_code,
    dosageinstruction_1_doseandrate_0_doserange_high_system,
    dosageinstruction_1_doseandrate_0_doserange_high_unit,
    dosageinstruction_1_doseandrate_0_doserange_high_value,
    dosageinstruction_1_doseandrate_0_doserange_low_code,
    dosageinstruction_1_doseandrate_0_doserange_low_system,
    dosageinstruction_1_doseandrate_0_doserange_low_unit,
    dosageinstruction_1_doseandrate_0_doserange_low_value,
    dosageinstruction_1_doseandrate_0_ratequantity,
    dosageinstruction_1_doseandrate_0_raterange_high_code,
    dosageinstruction_1_doseandrate_0_raterange_high_system,
    dosageinstruction_1_doseandrate_0_raterange_high_unit,
    dosageinstruction_1_doseandrate_0_raterange_high_value,
    dosageinstruction_1_doseandrate_0_raterange_low_code,
    dosageinstruction_1_doseandrate_0_raterange_low_system,
    dosageinstruction_1_doseandrate_0_raterange_low_unit,
    dosageinstruction_1_doseandrate_0_raterange_low_value,
    dosageinstruction_1_doseandrate_0_rateratio_denominator_code,
    dosageinstruction_1_doseandrate_0_rateratio_denominator_comparator,
    dosageinstruction_1_doseandrate_0_rateratio_denominator_system,
    dosageinstruction_1_doseandrate_0_rateratio_denominator_unit,
    dosageinstruction_1_doseandrate_0_rateratio_denominator_value,
    dosageinstruction_1_doseandrate_0_rateratio_numerator_code,
    dosageinstruction_1_doseandrate_0_rateratio_numerator_comparator,
    dosageinstruction_1_doseandrate_0_rateratio_numerator_system,
    dosageinstruction_1_doseandrate_0_rateratio_numerator_unit,
    dosageinstruction_1_doseandrate_0_rateratio_numerator_value,
    dosageinstruction_1_doseandrate_0_type_coding_0_code,
    dosageinstruction_1_doseandrate_0_type_coding_0_display,
    dosageinstruction_1_doseandrate_0_type_coding_0_system,
    dosageinstruction_1_doseandrate_0_type_coding_1_code,
    dosageinstruction_1_doseandrate_0_type_coding_1_display,
    dosageinstruction_1_doseandrate_0_type_coding_1_system,
    dosageinstruction_1_doseandrate_0_type_text,
    dosageinstruction_1_maxdoseperadministration,
    dosageinstruction_1_maxdoseperlifetime,
    dosageinstruction_1_maxdoseperperiod_denominator_code,
    dosageinstruction_1_maxdoseperperiod_denominator_comparator,
    dosageinstruction_1_maxdoseperperiod_denominator_system,
    dosageinstruction_1_maxdoseperperiod_denominator_unit,
    dosageinstruction_1_maxdoseperperiod_denominator_value,
    dosageinstruction_1_maxdoseperperiod_numerator_code,
    dosageinstruction_1_maxdoseperperiod_numerator_comparator,
    dosageinstruction_1_maxdoseperperiod_numerator_system,
    dosageinstruction_1_maxdoseperperiod_numerator_unit,
    dosageinstruction_1_maxdoseperperiod_numerator_value,
    dosageinstruction_1_method_coding_0_code,
    dosageinstruction_1_method_coding_0_display,
    dosageinstruction_1_method_coding_0_system,
    dosageinstruction_1_method_coding_1_code,
    dosageinstruction_1_method_coding_1_display,
    dosageinstruction_1_method_coding_1_system,
    dosageinstruction_1_method_text,
    dosageinstruction_1_patientinstruction,
    dosageinstruction_1_route_coding_0_code,
    dosageinstruction_1_route_coding_0_display,
    dosageinstruction_1_route_coding_0_system,
    dosageinstruction_1_route_coding_1_code,
    dosageinstruction_1_route_coding_1_display,
    dosageinstruction_1_route_coding_1_system,
    dosageinstruction_1_route_text,
    dosageinstruction_1_sequence,
    dosageinstruction_1_site_coding_0_code,
    dosageinstruction_1_site_coding_0_display,
    dosageinstruction_1_site_coding_0_system,
    dosageinstruction_1_site_coding_1_code,
    dosageinstruction_1_site_coding_1_display,
    dosageinstruction_1_site_coding_1_system,
    dosageinstruction_1_site_text,
    dosageinstruction_1_text,
    dosageinstruction_1_timing_code_coding_0_code,
    dosageinstruction_1_timing_code_coding_0_display,
    dosageinstruction_1_timing_code_coding_0_system,
    dosageinstruction_1_timing_code_coding_1_code,
    dosageinstruction_1_timing_code_coding_1_display,
    dosageinstruction_1_timing_code_coding_1_system,
    dosageinstruction_1_timing_code_text,
    dosageinstruction_1_timing_event_0,
    dosageinstruction_1_timing_event_1,
    dosageinstruction_1_timing_event_2,
    dosageinstruction_1_timing_repeat_boundsduration,
    dosageinstruction_1_timing_repeat_boundsperiod_end,
    dosageinstruction_1_timing_repeat_boundsperiod_start,
    dosageinstruction_1_timing_repeat_boundsrange_high_code,
    dosageinstruction_1_timing_repeat_boundsrange_high_system,
    dosageinstruction_1_timing_repeat_boundsrange_high_unit,
    dosageinstruction_1_timing_repeat_boundsrange_high_value,
    dosageinstruction_1_timing_repeat_boundsrange_low_code,
    dosageinstruction_1_timing_repeat_boundsrange_low_system,
    dosageinstruction_1_timing_repeat_boundsrange_low_unit,
    dosageinstruction_1_timing_repeat_boundsrange_low_value,
    dosageinstruction_1_timing_repeat_count,
    dosageinstruction_1_timing_repeat_countmax,
    dosageinstruction_1_timing_repeat_dayofweek_0,
    dosageinstruction_1_timing_repeat_dayofweek_1,
    dosageinstruction_1_timing_repeat_dayofweek_2,
    dosageinstruction_1_timing_repeat_duration,
    dosageinstruction_1_timing_repeat_durationmax,
    dosageinstruction_1_timing_repeat_durationunit,
    dosageinstruction_1_timing_repeat_frequency,
    dosageinstruction_1_timing_repeat_frequencymax,
    dosageinstruction_1_timing_repeat_offset,
    dosageinstruction_1_timing_repeat_period,
    dosageinstruction_1_timing_repeat_periodmax,
    dosageinstruction_1_timing_repeat_periodunit,
    dosageinstruction_1_timing_repeat_timeofday_0,
    dosageinstruction_1_timing_repeat_timeofday_1,
    dosageinstruction_1_timing_repeat_timeofday_2,
    dosageinstruction_1_timing_repeat_when_0,
    dosageinstruction_1_timing_repeat_when_1,
    dosageinstruction_1_timing_repeat_when_2,
    encounter_reference,
    eventhistory_0_reference,
    eventhistory_1_reference,
    groupidentifier_0_system,
    groupidentifier_0_type_text,
    groupidentifier_0_value,
    groupidentifier_1_system,
    groupidentifier_1_type_text,
    groupidentifier_1_value,
    insurance_0_reference,
    insurance_1_reference,
    intent,
    medicationcodeableconcept_coding_0_code,
    medicationcodeableconcept_coding_0_display,
    medicationcodeableconcept_coding_0_system,
    medicationcodeableconcept_coding_1_code,
    medicationcodeableconcept_coding_1_display,
    medicationcodeableconcept_coding_1_system,
    medicationcodeableconcept_text,
    medicationreference_reference,
    note_0_author_reference,
    note_0_text,
    note_0_time,
    note_1_author_reference,
    note_1_text,
    note_1_time,
    note_2_author_reference,
    note_2_text,
    note_2_time,
    note_3_author_reference,
    note_3_text,
    note_3_time,
    note_4_author_reference,
    note_4_text,
    note_4_time,
    performer_reference,
    performertype_coding_0_code,
    performertype_coding_0_display,
    performertype_coding_0_system,
    performertype_coding_1_code,
    performertype_coding_1_display,
    performertype_coding_1_system,
    performertype_text,
    priority,
    priorprescription_reference,
    reasoncode_coding_0_code,
    reasoncode_coding_0_display,
    reasonreference_reference,
    recorder_reference,
    reportedboolean,
    reportedreference_reference,
    requester_reference,
    status,
    statusreason_coding_0_code,
    statusreason_coding_0_display,
    statusreason_coding_0_system,
    statusreason_coding_1_code,
    statusreason_coding_1_display,
    statusreason_coding_1_system,
    statusreason_text,
    substitution_allowedboolean,
    substitution_allowedcodeableconcept_coding_0_code,
    substitution_allowedcodeableconcept_coding_0_display,
    substitution_allowedcodeableconcept_coding_0_system,
    substitution_allowedcodeableconcept_coding_1_code,
    substitution_allowedcodeableconcept_coding_1_display,
    substitution_allowedcodeableconcept_coding_1_system,
    substitution_allowedcodeableconcept_text,
    substitution_reason_coding_0_code,
    substitution_reason_coding_0_display,
    substitution_reason_coding_0_system,
    substitution_reason_coding_1_code,
    substitution_reason_coding_1_display,
    substitution_reason_coding_1_system,
    substitution_reason_text,
    supportinginformation_0_reference,
    supportinginformation_1_reference,
    filename,
    processed_date 
FROM {{source('raw', 'medicationrequest') }} x

QUALIFY rank() over(partition by filename order by processed_date desc) = 1