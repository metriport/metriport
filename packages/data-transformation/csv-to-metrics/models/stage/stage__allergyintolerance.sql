
-- SELECT statement for AllergyIntolerance
SELECT 
    resourcetype,
    id,
    meta_versionid,
    meta_lastupdated,
    meta_source,
    identifier_0_system,
    identifier_0_value,
    identifier_1_system,
    identifier_1_value,
    identifier_2_system,
    identifier_2_value,
    identifier_3_system,
    identifier_3_value,
    identifier_4_system,
    identifier_4_value,
    clinicalstatus_coding_0_system,
    patient_reference,
    recorder_reference,
    reaction_0_substance_text,
    reaction_0_substance_coding_0_system,
    reaction_0_substance_coding_0_code,
    reaction_0_substance_coding_0_display,
    reaction_0_substance_coding_1_system,
    reaction_0_substance_coding_1_code,
    reaction_0_substance_coding_1_display,
    reaction_0_substance_coding_2_system,
    reaction_0_substance_coding_2_code,
    reaction_0_substance_coding_2_display,
    reaction_0_manifestation_0_coding_0_system,
    reaction_0_manifestation_0_coding_0_code,
    reaction_0_manifestation_0_coding_0_display,
    reaction_0_manifestation_0_text,
    clinicalstatus_coding_0_code,
    onsetdatetime,
    reaction_0_onset,
    reaction_0_substance_coding_3_system,
    reaction_0_substance_coding_3_code,
    reaction_0_substance_coding_4_system,
    reaction_0_substance_coding_4_code,
    reaction_0_manifestation_1_coding_0_system,
    reaction_0_manifestation_1_coding_0_code,
    reaction_0_manifestation_1_coding_0_display,
    reaction_0_substance_coding_5_system,
    reaction_0_substance_coding_5_code,
    reaction_0_substance_coding_6_system,
    reaction_0_substance_coding_6_code,
    reaction_0_substance_coding_7_system,
    reaction_0_substance_coding_7_code,
    reaction_0_substance_coding_8_system,
    reaction_0_substance_coding_8_code,
    reaction_0_substance_coding_9_system,
    reaction_0_substance_coding_9_code,
    reaction_0_substance_coding_10_system,
    reaction_0_substance_coding_10_code,
    reaction_0_substance_coding_11_system,
    reaction_0_substance_coding_11_code,
    reaction_0_substance_coding_12_system,
    reaction_0_substance_coding_12_code,
    reaction_0_substance_coding_13_system,
    reaction_0_substance_coding_13_code,
    reaction_0_substance_coding_14_system,
    reaction_0_substance_coding_14_code,
    reaction_0_substance_coding_15_system,
    reaction_0_substance_coding_15_code,
    reaction_0_substance_coding_16_system,
    reaction_0_substance_coding_16_code,
    reaction_0_substance_coding_17_system,
    reaction_0_substance_coding_17_code,
    reaction_0_substance_coding_18_system,
    reaction_0_substance_coding_18_code,
    reaction_0_substance_coding_19_system,
    reaction_0_substance_coding_19_code,
    reaction_0_substance_coding_20_system,
    reaction_0_substance_coding_20_code,
    reaction_0_substance_coding_21_system,
    reaction_0_substance_coding_21_code,
    reaction_0_substance_coding_22_system,
    reaction_0_substance_coding_22_code,
    reaction_0_substance_coding_23_system,
    reaction_0_substance_coding_23_code,
    reaction_0_substance_coding_24_system,
    reaction_0_substance_coding_24_code,
    reaction_0_substance_coding_25_system,
    reaction_0_substance_coding_25_code,
    reaction_0_substance_coding_26_system,
    reaction_0_substance_coding_26_code,
    reaction_0_substance_coding_27_system,
    reaction_0_substance_coding_27_code,
    reaction_0_substance_coding_28_system,
    reaction_0_substance_coding_28_code,
    reaction_0_substance_coding_29_system,
    reaction_0_substance_coding_29_code,
    reaction_0_substance_coding_30_system,
    reaction_0_substance_coding_30_code,
    reaction_0_substance_coding_31_system,
    reaction_0_substance_coding_31_code,
    reaction_0_substance_coding_32_system,
    reaction_0_substance_coding_32_code,
    reaction_0_substance_coding_33_system,
    reaction_0_substance_coding_33_code,
    reaction_0_substance_coding_34_system,
    reaction_0_substance_coding_34_code,
    reaction_0_substance_coding_35_system,
    reaction_0_substance_coding_35_code,
    reaction_0_substance_coding_36_system,
    reaction_0_substance_coding_36_code,
    reaction_0_substance_coding_37_system,
    reaction_0_substance_coding_37_code,
    reaction_0_substance_coding_38_system,
    reaction_0_substance_coding_38_code,
    reaction_0_substance_coding_39_system,
    reaction_0_substance_coding_39_code,
    reaction_0_substance_coding_40_system,
    reaction_0_substance_coding_40_code,
    reaction_0_substance_coding_41_system,
    reaction_0_substance_coding_41_code,
    reaction_0_substance_coding_42_system,
    reaction_0_substance_coding_42_code,
    reaction_0_substance_coding_43_system,
    reaction_0_substance_coding_43_code,
    reaction_0_substance_coding_44_system,
    reaction_0_substance_coding_44_code,
    reaction_0_substance_coding_45_system,
    reaction_0_substance_coding_45_code,
    reaction_0_substance_coding_46_system,
    reaction_0_substance_coding_46_code,
    reaction_0_substance_coding_47_system,
    reaction_0_substance_coding_47_code,
    reaction_0_substance_coding_48_system,
    reaction_0_substance_coding_48_code,
    reaction_0_substance_coding_49_system,
    reaction_0_substance_coding_49_code,
    reaction_0_substance_coding_50_system,
    reaction_0_substance_coding_50_code,
    reaction_0_substance_coding_51_system,
    reaction_0_substance_coding_51_code,
    reaction_0_substance_coding_52_system,
    reaction_0_substance_coding_52_code,
    reaction_0_substance_coding_53_system,
    reaction_0_substance_coding_53_code,
    reaction_0_substance_coding_54_system,
    reaction_0_substance_coding_54_code,
    reaction_0_substance_coding_55_system,
    reaction_0_substance_coding_55_code,
    reaction_0_substance_coding_56_system,
    reaction_0_substance_coding_56_code,
    reaction_0_substance_coding_57_system,
    reaction_0_substance_coding_57_code,
    reaction_0_substance_coding_58_system,
    reaction_0_substance_coding_58_code,
    identifier_0_type_text,
    filename,
    processed_date 
FROM {{source('raw', 'allergyintolerance') }} x

QUALIFY rank() over(partition by filename order by processed_date desc) = 1