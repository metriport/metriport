
-- SELECT statement for Procedure
SELECT 
    resourcetype,
    id,
    meta_versionid,
    meta_lastupdated,
    meta_source,
    identifier_0_system,
    identifier_0_value,
    status,
    subject_reference,
    performedperiod_start,
    performedperiod_end,
    note_0_text,
    code_coding_0_system,
    code_coding_0_code,
    code_coding_0_display,
    code_text,
    performeddatetime,
    performer_0_actor_reference,
    reasoncode_0_coding_0_system,
    reasoncode_0_coding_0_code,
    code_coding_1_system,
    code_coding_1_code,
    code_coding_1_display,
    identifier_1_system,
    identifier_1_value,
    reasoncode_1_coding_0_system,
    reasoncode_1_coding_0_code,
    identifier_2_system,
    identifier_2_value,
    identifier_3_system,
    identifier_3_value,
    identifier_4_system,
    identifier_4_value,
    identifier_5_system,
    identifier_5_value,
    identifier_6_system,
    identifier_6_value,
    identifier_7_system,
    identifier_7_value,
    code_coding_2_system,
    code_coding_2_code,
    code_coding_2_display,
    code_coding_3_system,
    code_coding_3_code,
    code_coding_3_display,
    code_coding_4_system,
    code_coding_4_code,
    code_coding_4_display,
    code_coding_5_system,
    code_coding_5_code,
    code_coding_5_display,
    code_coding_6_system,
    code_coding_6_code,
    code_coding_6_display,
    code_coding_7_system,
    code_coding_7_code,
    code_coding_7_display,
    note_1_text,
    note_2_text,
    note_3_text,
    note_4_text,
    note_5_text,
    note_6_text,
    note_7_text,
    reasoncode_2_coding_0_system,
    reasoncode_2_coding_0_code,
    performer_1_actor_reference,
    reasoncode_3_coding_0_code,
    reasoncode_3_coding_0_system,
    reasoncode_4_coding_0_code,
    reasoncode_4_coding_0_system,
    reasoncode_5_coding_0_code,
    reasoncode_5_coding_0_system,
    reasoncode_6_coding_0_code,
    reasoncode_6_coding_0_system,
    reasoncode_7_coding_0_code,
    reasoncode_7_coding_0_system,
    reasoncode_8_coding_0_code,
    reasoncode_8_coding_0_system,
    reasoncode_9_coding_0_code,
    reasoncode_9_coding_0_system,
    reasoncode_10_coding_0_code,
    reasoncode_10_coding_0_system,
    reasoncode_11_coding_0_code,
    reasoncode_11_coding_0_system,
    reasoncode_12_coding_0_code,
    reasoncode_12_coding_0_system,
    reasoncode_13_coding_0_code,
    reasoncode_13_coding_0_system,
    reasoncode_14_coding_0_code,
    reasoncode_14_coding_0_system,
    performer_2_actor_reference,
    performer_3_actor_reference,
    identifier_0_type_text,
    identifier_8_system,
    identifier_8_value,
    performer_4_actor_reference,
    performer_5_actor_reference,
    performer_6_actor_reference,
    performer_7_actor_reference,
    performer_8_actor_reference,
    performer_9_actor_reference,
    performer_10_actor_reference,
    performer_11_actor_reference,
    performer_12_actor_reference,
    performer_13_actor_reference,
    performer_14_actor_reference,
    performer_15_actor_reference,
    performer_16_actor_reference,
    performer_17_actor_reference,
    performer_18_actor_reference,
    performer_19_actor_reference,
    performer_20_actor_reference,
    performer_21_actor_reference,
    performer_22_actor_reference,
    performer_23_actor_reference,
    performer_24_actor_reference,
    performer_25_actor_reference,
    performer_26_actor_reference,
    performer_27_actor_reference,
    performer_28_actor_reference,
    performer_29_actor_reference,
    performer_30_actor_reference,
    performer_31_actor_reference,
    performer_32_actor_reference,
    performer_33_actor_reference,
    performer_34_actor_reference,
    performer_35_actor_reference,
    bodysite_0_text,
    filename,
    processed_date 
FROM {{source('raw', 'procedure') }} x

QUALIFY rank() over(partition by filename order by processed_date desc) = 1