FROM public.ecr.aws/lambda/python:3.12

COPY requirements.txt ${LAMBDA_TASK_ROOT}
RUN pip install -r requirements.txt
RUN pip install dbt-core dbt-postgres
RUN dbt deps
COPY . ${LAMBDA_TASK_ROOT}
ENV PYTHONUNBUFFERED=1

CMD ["main.handler"]
