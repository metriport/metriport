
-- SELECT statement for Patient
SELECT 
    resourcetype,
    id,
    meta_versionid,
    meta_lastupdated,
    meta_source,
    identifier_0_system,
    identifier_0_type_text,
    identifier_0_value,
    identifier_1_system,
    identifier_1_type_text,
    identifier_1_value,
    identifier_2_system,
    identifier_2_type_text,
    identifier_2_value,
    identifier_3_system,
    identifier_3_type_text,
    identifier_3_value,
    identifier_4_system,
    identifier_4_type_text,
    identifier_4_value,
    address_0_city,
    address_0_country,
    address_0_line_0,
    address_0_line_1,
    address_0_postalcode,
    address_0_state,
    address_1_city,
    address_1_country,
    address_1_line_0,
    address_1_line_1,
    address_1_postalcode,
    address_1_state,
    address_2_city,
    address_2_country,
    address_2_line_0,
    address_2_line_1,
    address_2_postalcode,
    address_2_state,
    address_3_city,
    address_3_country,
    address_3_line_0,
    address_3_line_1,
    address_3_postalcode,
    address_3_state,
    address_4_city,
    address_4_country,
    address_4_line_0,
    address_4_line_1,
    address_4_postalcode,
    address_4_state,
    birthdate,
    deceasedboolean,
    deceaseddatetime,
    gender,
    maritalstatus_coding_0_code,
    maritalstatus_coding_0_display,
    maritalstatus_coding_0_system,
    maritalstatus_coding_1_code,
    maritalstatus_coding_1_display,
    maritalstatus_coding_1_system,
    maritalstatus_text,
    name_0_family,
    name_0_given_0,
    name_0_given_1,
    name_0_given_2,
    name_0_given_3,
    name_0_given_4,
    name_1_family,
    name_1_given_0,
    name_1_given_1,
    name_1_given_2,
    name_1_given_3,
    name_1_given_4,
    name_2_family,
    name_2_given_0,
    name_2_given_1,
    name_2_given_2,
    name_2_given_3,
    name_2_given_4,
    telecom_0_system,
    telecom_0_value,
    telecom_1_system,
    telecom_1_value,
    telecom_2_system,
    telecom_2_value,
    telecom_3_system,
    telecom_3_value,
    telecom_4_system,
    telecom_4_value,
    text_div,
    text_status,
    filename,
    processed_date 
FROM {{source('raw', 'patient') }} x

QUALIFY rank() over(partition by filename order by processed_date desc) = 1