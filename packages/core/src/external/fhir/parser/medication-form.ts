/**
 * Query the MEDICATION_FORM_MAP for the SNOMED-CT code related to the medication form.
 */
export function getMedicationForm(text: string): string | undefined {
  const queryString = text
    .toLowerCase()
    .replace(/[^a-z\-/\s]/g, "")
    .trim();
  return MEDICATION_FORM_MAP[queryString];
}

/**
 * Standard value set for SNOMED-CT codes related to medication forms for FHIR R4.
 * https://hl7.org/fhir/R4/valueset-medication-form-codes.html
 */
const MEDICATION_FORM_MAP: Record<string, string> = Object.fromEntries([
  ["drug suspension", "7946007"],
  ["drug stick", "11190007"],
  ["lotion", "17519006"],
  ["drug aerosol foam", "30843009"],
  ["drug patch", "36875001"],
  ["drug paste", "37937005"],
  ["pill", "46992007"],
  ["caplet", "48582000"],
  ["drug aerosol", "52262001"],
  ["liniment", "63316001"],
  ["drug pledget", "64241004"],
  ["chewable tablet", "66076007"],
  ["drug solution", "77899000"],
  ["drug powder", "85581007"],
  ["oral drops", "385018001"],
  ["oral drops solution", "385019009"],
  ["oral drops suspension", "385020003"],
  ["oral drops emulsion", "385021004"],
  ["oral liquid", "385022006"],
  ["oral solution", "385023001"],
  ["suspension", "385024007"], // defaults to oral suspension
  ["oral suspension", "385024007"],
  ["oral emulsion", "385025008"],
  ["powder for oral solution", "385026009"],
  ["powder for oral suspension", "385027000"],
  ["granules for oral solution", "385028005"],
  ["granules for oral suspension", "385029002"],
  ["syrup", "385032004"],
  ["powder for syrup", "385033009"],
  ["granules for syrup", "385034003"],
  ["soluble tablet", "385035002"],
  ["dispersible tablet", "385036001"],
  ["oral gel", "385038000"],
  ["oral paste", "385039008"],
  ["oral powder", "385041009"],
  ["effervescent powder", "385042002"],
  ["granules", "385043007"],
  ["effervescent granules", "385044001"],
  ["gastro-resistant granules", "385045000"],
  ["prolonged-release granules", "385046004"],
  ["modified-release granules", "385047008"],
  ["cachet", "385048003"],
  ["capsule", "385049006"],
  ["hard capsule", "385050006"],
  ["soft capsule", "385051005"],
  ["gastro-resistant capsule", "385052003"],
  ["prolonged-release capsule", "385053008"],
  ["modified-release capsule", "385054002"],
  ["tablet", "385055001"],
  ["film-coated tablet", "385057009"],
  ["effervescent tablet", "385058004"],
  ["gastro-resistant tablet", "385059007"],
  ["prolonged-release tablet", "385060002"],
  ["modified-release tablet", "385061003"],
  ["oral lyophilisate", "385062005"],
  ["oral gum", "385063000"],
  ["pillule", "385064006"],
  ["oromucosal liquid", "385069001"],
  ["oromucosal solution", "385070000"],
  ["oromucosal suspension", "385071001"],
  ["oromucosal spray", "385073003"],
  ["sublingual spray", "385074009"],
  ["gingival solution", "385077002"],
  ["oromucosal gel", "385078007"],
  ["oromucosal paste", "385079004"],
  ["medicated chewing-gum", "385080001"],
  ["gingival gel", "385081002"],
  ["gingival paste", "385082009"],
  ["oromucosal capsule", "385083004"],
  ["sublingual tablet", "385084005"],
  ["buccal tablet", "385085006"],
  ["muco-adhesive buccal tablet", "385086007"],
  ["lozenge", "385087003"],
  ["dental gel", "385088008"],
  ["dental stick", "385089000"],
  ["dental insert", "385090009"],
  ["dental powder", "385091008"],
  ["dental liquid", "385092001"],
  ["dental solution", "385094000"],
  ["dental suspension", "385095004"],
  ["dental emulsion", "385096003"],
  ["bath additive", "385098002"],
  ["cream", "385099005"],
  ["gel", "385100002"],
  ["ointment", "385101003"],
  ["cutaneous paste", "385102005"],
  ["cutaneous foam", "385103000"],
  ["shampoo", "385104006"],
  ["cutaneous spray", "385105007"],
  ["cutaneous solution spray", "385106008"],
  ["cutaneous liquid", "385107004"],
  ["cutaneous solution", "385108009"],
  ["cutaneous suspension", "385110006"],
  ["cutaneous emulsion", "385111005"],
  ["cutaneous powder", "385112003"],
  ["solution for iontophoresis", "385113008"],
  ["transdermal patch", "385114002"],
  ["collodion", "385115001"],
  ["medicated nail lacquer", "385116000"],
  ["poultice", "385117009"],
  ["cutaneous stick", "385118004"],
  ["cutaneous sponge", "385119007"],
  ["eye cream", "385121002"],
  ["eye gel", "385122009"],
  ["eye ointment", "385123004"],
  ["eye drops", "385124005"],
  ["eye drops solution", "385125006"],
  ["prolonged-release eye drops", "385128008"],
  ["eye lotion", "385130005"],
  ["ophthalmic insert", "385132002"],
  ["ear cream", "385133007"],
  ["ear gel", "385134001"],
  ["ear ointment", "385135000"],
  ["ear drops", "385136004"],
  ["ear drops solution", "385137008"],
  ["ear drops emulsion", "385138003"],
  ["ear powder", "385139006"],
  ["ear spray", "385140008"],
  ["ear spray solution", "385141007"],
  ["ear spray suspension", "385142000"],
  ["ear spray emulsion", "385143005"],
  ["ear tampon", "385147006"],
  ["ear stick", "385148001"],
  ["nasal cream", "385149009"],
  ["nasal gel", "385150009"],
  ["nasal ointment", "385151008"],
  ["nasal drops", "385152001"],
  ["nasal drops solution", "385153006"],
  ["nasal drops suspension", "385154000"],
  ["nasal drops emulsion", "385155004"],
  ["nasal powder", "385156003"],
  ["nasal spray", "385157007"],
  ["nasal spray solution", "385158002"],
  ["nasal spray suspension", "385159005"],
  ["nasal spray emulsion", "385160000"],
  ["nasal stick", "385162008"],
  ["eye/ear/nose drops", "385163003"],
  ["eye/ear/nose ointment", "385164009"],
  ["vaginal cream", "385165005"],
  ["vaginal gel", "385166006"],
  ["vaginal ointment", "385167002"],
  ["vaginal foam", "385168007"],
  ["vaginal liquid", "385169004"],
  ["vaginal solution", "385170003"],
  ["vaginal suspension", "385171004"],
  ["vaginal emulsion", "385172006"],
  ["tablet for vaginal solution", "385173001"],
  ["pessary", "385174007"],
  ["vaginal capsule", "385175008"],
  ["hard vaginal capsule", "385176009"],
  ["soft vaginal capsule", "385177000"],
  ["vaginal tablet", "385178005"],
  ["effervescent vaginal tablet", "385179002"],
  ["medicated vaginal tampon", "385180004"],
  ["rectal cream", "385182007"],
  ["rectal gel", "385183002"],
  ["rectal ointment", "385184008"],
  ["rectal foam", "385185009"],
  ["enema", "385186005"],
  ["rectal solution", "385187001"],
  ["rectal suspension", "385188006"],
  ["rectal emulsion", "385189003"],
  ["powder for rectal suspension", "385191006"],
  ["tablet for rectal solution", "385192004"],
  ["tablet for rectal suspension", "385193009"],
  ["suppository", "385194003"],
  ["rectal capsule", "385195002"],
  ["rectal tampon", "385196001"],
  ["nebulizer liquid", "385197005"],
  ["nebulizer solution", "385198000"],
  ["nebulizer suspension", "385199008"],
  ["powder for nebulizer suspension", "385200006"],
  ["powder for nebulizer solution", "385201005"],
  ["nebulizer emulsion", "385202003"],
  ["pressurised inhalation", "385203008"],
  ["pressurised inhalation solution", "385204002"],
  ["pressurised inhalation suspension", "385205001"],
  ["pressurised inhalation emulsion", "385206000"],
  ["inhalation powder", "385207009"],
  ["hard capsule inhalation powder", "385208004"],
  ["inhalation vapor", "385210002"],
  ["inhalation vapor powder", "385211003"],
  ["inhalation vapor capsule", "385212005"],
  ["inhalation vapor solution", "385213000"],
  ["inhalation vapor tablet", "385214006"],
  ["inhalation vapor ointment", "385215007"],
  ["inhalation vapor liquid", "385216008"],
  ["inhalation gas", "385217004"],
  ["injection solution", "385219001"],
  ["injection suspension", "385220007"],
  ["injection emulsion", "385221006"],
  ["injection powder", "385222004"],
  ["powder for injection solution", "385223009"],
  ["powder for injection suspension", "385224003"],
  ["infusion solution", "385229008"],
  ["infusion powder", "385230003"],
  ["powder for infusion solution", "385231004"],
  ["implantation tablet", "385236009"],
  ["implantation chain", "385237000"],
  ["intravesical solution", "385242008"],
  ["urethral gel", "385245005"],
  ["urethral stick", "385246006"],
  ["endotracheopulmonary instillation solution", "385247002"],
  ["powder for endotracheopulmonary instillation solution", "385248007"],
  ["endotracheopulmonary instillation suspension", "385250004"],
  ["endocervical gel", "385251000"],
  ["gastroenteral liquid", "385257001"],
  ["gastroenteral solution", "385258006"],
  ["gastroenteral suspension", "385259003"],
  ["gastroenteral emulsion", "385260008"],
  ["wound stick", "385261007"],
  ["organ preservation solution", "385262000"],
  ["cutaneous powder spray", "385278003"],
  ["cutaneous suspension spray", "385279006"],
  ["implant dosage form", "385286003"],
  ["oral elixir", "414951009"],
  ["tampon dose form", "420243009"],
  ["oil injection", "420253005"],
  ["semi-solid dose form", "420275007"],
  ["nasal emulsion", "420283001"],
  ["rectal powder", "420292003"],
  ["coated pellets capsule", "420293008"],
  ["powder for oral liquid", "420305009"],
  ["inhaler", "420317006"],
  ["extended-release film coated tablet", "420378007"],
  ["extended-release insert", "420385006"],
  ["emulsion", "420386007"],
  ["inhalation aerosol solution", "420407000"],
  ["lyophilized powder for injectable extended release liposomal suspension", "420430006"],
  ["pressurized nebulizer suspension", "420450005"],
  ["film", "420460001"],
  ["oral granules", "420509004"],
  ["vaginal powder", "420536002"],
  ["cutaneous oil", "420540006"],
  ["nasal aerosol", "420610000"],
  ["extended-release tablet", "420627008"],
  ["vaginal insert", "420631002"],
  ["microspheres for injectable suspension", "420634005"],
  ["eye/ear drops", "420636007"],
  ["solution for inhalation", "420641004"],
  ["lyophilized powder for injectable liposomal suspension", "420656008"],
  ["oral capsule", "420692007"],
  ["liquid dose form", "420699003"],
  ["inhalation aerosol suspension", "420705007"],
  ["eye suspension", "420736004"],
  ["delayed-release granules", "420757007"],
  ["urethral suppository", "420761001"],
  ["delayed-release pellets capsule", "420767002"],
  ["pellet", "420768007"],
  ["extended-release liquid", "420802004"],
  ["powder for reconstitution for drug product", "420828001"],
  ["metered dose aerosol", "420847003"],
  ["extended release injectable suspension", "420873008"],
  ["intrathecal suspension", "420887008"],
  ["ear drops suspension", "420891003"],
  ["ear emulsion", "420901005"],
  ["metered powder", "420927005"],
  ["rectal suppository", "420929008"],
  ["powder for solution", "420955009"],
  ["ultramicronized tablet", "420956005"],
  ["implantable pellet", "420992009"],
  ["oral tablet", "421026006"],
  ["delayed-release capsule", "421027002"],
  ["extended-release suppository", "421034000"],
  ["extended-release film", "421043009"],
  ["sonicated injectable suspension", "421051007"],
  ["emulsion for inhalation", "421056002"],
  ["pastille", "421079001"],
  ["powder for suspension", "421080003"],
  ["aerosol powder", "421104008"],
  ["gaseous dose form", "421131006"],
  ["extended-release enteric coated tablet", "421155001"],
  ["foam", "421166008"],
  ["vaginal suppository", "421195004"],
  ["suspension for inhalation", "421221008"],
  ["extended-release bead implant", "421271006"],
  ["sponge", "421288004"],
  ["extended-release film coated capsule", "421300005"],
  ["powder for eye drops", "421316007"],
  ["extended-release coated capsule", "421338009"],
  ["powder spray", "421340004"],
  ["powder for cutaneous solution", "421343002"],
  ["cutaneous aerosol", "421347001"],
  ["tablet for oral suspension", "421366001"],
  ["delayed-release tablet", "421374000"],
  ["solid dose form", "421378002"],
  ["ear suspension", "421382000"],
  ["intravenous solution", "421410002"],
  ["powder for inhalation solution", "421425002"],
  ["eye/ear ointment", "421427005"],
  ["injectable oil suspension", "421428000"],
  ["extended-release granules for suspension", "421446006"],
  ["cone", "421504000"],
  ["liposomal injectable suspension", "421522002"],
  ["insert", "421532009"],
  ["delayed-release particles tablet", "421535006"],
  ["powder for ear drops", "421575003"],
  ["aerosol spray", "421606006"],
  ["powder for nasal drops", "421607002"],
  ["extended-release capsule", "421618002"],
  ["sustained-release buccal tablet", "421620004"],
  ["cutaneous cream", "421628006"],
  ["lyophilized powder for injectable solution", "421637006"],
  ["metered gel", "421669002"],
  ["tablet for oral solution", "421701006"],
  ["ear solution", "421713001"],
  ["transdermal drug delivery system", "421716009"],
  ["spray dose form", "421720008"],
  ["coated particles tablet", "421721007"],
  ["extended-release enteric coated capsule", "421752008"],
  ["metered dose aerosol inhaler", "421759004"],
  ["intraperitoneal solution", "421765004"],
  ["powder for ophthalmic solution", "421857007"],
  ["oral cream", "421873001"],
  ["oil", "421890007"],
  ["multilayer tablet", "421932003"],
  ["medicated toothpaste", "421937009"],
  ["lyophilized powder for injectable suspension", "421943006"],
  ["cutaneous gel", "421949005"],
  ["intraocular solution", "421987002"],
  ["extended-release coated pellets", "421999009"],
  ["metered dose powder inhaler", "422054001"],
  ["metered dose inhaler", "422059006"],
  ["ophthalmic solution", "422060001"],
  ["eye drops suspension", "422068008"],
  ["nasal suspension", "422080000"],
  ["powder for ophthalmic suspension", "422085005"],
  ["breath activated powder inhaler", "422151007"],
  ["tincture", "422186009"],
  ["breath activated inhaler", "422197009"],
  ["dental cone", "422199007"],
  ["tablet for cutaneous solution", "422201009"],
  ["colloidal suspension for injection", "422202002"],
  ["spirit", "422259002"],
  ["powder for injectable extended release suspension", "422264003"],
  ["modified-release pessary", "422301006"],
  ["nasal solution", "422336005"],
  ["extended-release suspension", "422353003"],
  ["aerosol generator", "424179000"],
  ["vaginal sponge", "424552006"],
  ["topical ointment", "425753008"],
  ["rectal spray", "425965000"],
  ["gum", "426210003"],
  ["drops dose form", "426684005"],
  ["vaginal spray", "426823003"],
  ["metered spray", "426969004"],
  ["coated capsule", "427129005"],
  ["pressurized spray", "427564005"],
  ["modified release drops dose form", "427609008"],
  ["bar", "429885007"],
  ["buccal film", "443424002"],
  ["orodispersible film", "447050008"],
  ["orodispersible tablet", "447079001"],
]);
